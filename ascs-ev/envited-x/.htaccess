Header set Access-Control-Allow-Origin *

# MIME types for RDF serializations
AddType application/rdf+xml .rdf
AddType application/rdf+xml .owl
AddType text/turtle .ttl
AddType application/n-triples .nt
AddType application/ld+json .json
AddType application/ld+json .jsonld

Options +FollowSymLinks
RewriteEngine on

# =============================================================================
# ENVITED-X Simulation Asset Ontologies - Static GitHub Pages resolution
# Pattern: /ascs-ev/envited-x/{ontology}/{version}[/][shapes]
# =============================================================================

# Turtle format requests -> static TTL
RewriteCond %{HTTP_ACCEPT} text/turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/rdf\+xml
RewriteRule ^([^/]+)/(v[0-9]+|latest)/?$ https://ascs-ev.github.io/ontology-management-base/w3id/ascs-ev/envited-x/$1/$2/ontology.ttl [R=303,L]

# SHACL Shapes requests -> static TTL
RewriteCond %{HTTP_ACCEPT} text/turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/rdf\+xml
RewriteRule ^([^/]+)/(v[0-9]+|latest)/shapes/?$ https://ascs-ev.github.io/ontology-management-base/w3id/ascs-ev/envited-x/$1/$2/shapes.ttl [R=303,L]

# JSON-LD requests -> static TTL (JSON-LD not published yet)
RewriteCond %{HTTP_ACCEPT} application/ld\+json [OR]
RewriteCond %{HTTP_ACCEPT} application/json
RewriteRule ^([^/]+)/(v[0-9]+|latest)/?$ https://ascs-ev.github.io/ontology-management-base/w3id/ascs-ev/envited-x/$1/$2/ontology.ttl [R=303,L]

# JSON-LD shapes requests -> static TTL (JSON-LD not published yet)
RewriteCond %{HTTP_ACCEPT} application/ld\+json [OR]
RewriteCond %{HTTP_ACCEPT} application/json
RewriteRule ^([^/]+)/(v[0-9]+|latest)/shapes/?$ https://ascs-ev.github.io/ontology-management-base/w3id/ascs-ev/envited-x/$1/$2/shapes.ttl [R=303,L]

# Base IRI (no version) -> latest
RewriteRule ^([^/]+)/?$ https://ascs-ev.github.io/ontology-management-base/w3id/ascs-ev/envited-x/$1/latest/ontology.ttl [R=303,L]

# -----------------------------------------------------------------------------
# Default: Redirect to documentation (HTML)
# -----------------------------------------------------------------------------
RewriteRule ^([^/]+)/(v[0-9]+|latest)/?$ https://ascs-ev.github.io/ontology-management-base/ontologies/#$1 [R=303,L]
RewriteRule ^([^/]+)/(v[0-9]+|latest)/shapes/?$ https://ascs-ev.github.io/ontology-management-base/ontologies/#$1 [R=303,L]

# -----------------------------------------------------------------------------
# Root redirect to documentation
# -----------------------------------------------------------------------------
RewriteRule ^$ https://ascs-ev.github.io/ontology-management-base/ [R=303,L]
