# Target: https://abdullahikawu.github.io/pghdprovo
# Turn off MultiViews
Options -MultiViews

# Directive to ensure *.rdf files served as appropriate content type,
AddType application/n-triples .nt
AddType application/owl+xml .owl
AddType text/turtle .ttl
AddType application/ld+json .jsonld

# Preserve host header when proxying
ProxyPreserveHost On

Header set Access-Control-Allow-Origin *
Options +FollowSymLinks
RewriteEngine on

# ==============================================================================
# PART 1: HANDLE SPECIFIC VERSIONS (e.g., w3id.org/pghdprovo/1.0)
# ==============================================================================

# 1. N-Triples (.nt)
RewriteCond %{HTTP_ACCEPT} application/n-triples
RewriteRule ^(\d+\.\d)$ https://abdullahikawu.github.io/pghdprovo/releases/$1/pghdprovo.nt [P,L]

# 2. RDF/XML or OWL/XML (.owl)
RewriteCond %{HTTP_ACCEPT} application/rdf\+xml [OR]
RewriteCond %{HTTP_ACCEPT} application/owl\+xml
RewriteRule ^(\d+\.\d)$ https://abdullahikawu.github.io/pghdprovo/releases/$1/pghdprovo.owl [P,L]

# 3. Turtle (.ttl)
RewriteCond %{HTTP_ACCEPT} text/turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/x-turtle
RewriteRule ^(\d+\.\d)$ https://abdullahikawu.github.io/pghdprovo/releases/$1/pghdprovo.ttl [P,L]

# 4. JSON-LD (.json)
RewriteCond %{HTTP_ACCEPT} application/ld\+json
RewriteRule ^(\d+\.\d)$ https://abdullahikawu.github.io/pghdprovo/releases/$1/pghdprovo.json [P,L]

# 5. Default Fallback (Browsers/HTML)
# If none of the above matched, send the user to the documentation index
RewriteRule ^(\d+\.\d)$ https://abdullahikawu.github.io/pghdprovo/releases/$1 [P,L]
RewriteRule ^(\d+\.\d)/(.*)$ https://abdullahikawu.github.io/pghdprovo/releases/$1/$2 [P,L]


# ==============================================================================
# PART 2: HANDLE THE ROOT (Latest Version) (e.g., w3id.org/pghdprovo)
# ==============================================================================

# 1. N-Triples (.nt)
RewriteCond %{HTTP_ACCEPT} application/n-triples
RewriteRule ^$ https://abdullahikawu.github.io/pghdprovo/pghdprovo.nt [P,L]

# 2. RDF/XML or OWL/XML (.owl)
RewriteCond %{HTTP_ACCEPT} application/rdf\+xml [OR]
RewriteCond %{HTTP_ACCEPT} application/owl\+xml
RewriteRule ^$ https://abdullahikawu.github.io/pghdprovo/pghdprovo.owl [P,L]

# 3. Turtle (.ttl)
RewriteCond %{HTTP_ACCEPT} text/turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/x-turtle
RewriteRule ^$ https://abdullahikawu.github.io/pghdprovo/pghdprovo.ttl [P,L]

# 4. JSON-LD (.json)
RewriteCond %{HTTP_ACCEPT} application/ld\+json
RewriteRule ^$ https://abdullahikawu.github.io/pghdprovo/pghdprovo.json [P,L]

# 5. Default Fallback (Browsers/HTML)
RewriteRule ^$ https://abdullahikawu.github.io/pghdprovo [P,L]
RewriteRule ^(.*)$ https://abdullahikawu.github.io/pghdprovo/$1 [P,L]
