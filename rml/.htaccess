# RML Ontology
RewriteEngine on
DirectorySlash Off

## RML Ontology content negotiation
RewriteCond %{HTTP_ACCEPT} text/html
RewriteRule ^(.*)\.(core|io|cc|fnml|star).conneg$ https://kg-construct.github.io/rml-$2/ontology/documentation/index-en.html#http://w3id.org/$1 [NE,R,L]
RewriteCond %{HTTP_ACCEPT} application/ld\+json
RewriteRule ^(.*)\.(core|io|cc|fnml|star).conneg$ https://kg-construct.github.io/rml-$2/ontology/documentation/ontology.jsonld#http://w3id.org/$1 [NE,R,L]
RewriteCond %{HTTP_ACCEPT} application/n-triples
RewriteRule ^(.*)\.(core|io|cc|fnml|star).conneg$ https://kg-construct.github.io/rml-$2/ontology/documentation/ontology.nt#http://w3id.org/$1 [NE,R,L]
RewriteCond %{HTTP_ACCEPT} application/rdf\+xml
RewriteRule ^(.*)\.(core|io|cc|fnml|star).conneg$ https://kg-construct.github.io/rml-$2/ontology/documentation/ontology.rdf#http://w3id.org/$1 [NE,R,L]
RewriteCond %{HTTP_ACCEPT} text/turtle
RewriteRule ^(.*)\.(core|io|cc|fnml|star).conneg$ https://kg-construct.github.io/rml-$2/ontology/documentation/ontology.ttl#http://w3id.org/$1 [NE,R,L]
RewriteCond %{HTTP_ACCEPT} .+

RewriteRule ^(.*)\.(core|io|cc|fnml|star).conneg$ https://kg-construct.github.io/rml-resources/406.html [NE,L,R=406]
# === RML cc ===
RewriteCond %{REQUEST_URI} ^/rml/cc
RewriteRule ^rml/cc/?$ https://kg-construct.github.io/rml-cc/ontology/documentation/index-en.html [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/cc/spec
RewriteRule ^rml/cc/spec/?$ https://kg-construct.github.io/rml-cc/spec/docs [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/cc/shapes
RewriteRule ^rml/cc/shapes/?$ https://kg-construct.github.io/rml-cc/shapes/cc.ttl [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/(gatherAs|allowEmptyListAndContainer|gather|GatherMap|append|cartessianProduct)$
RewriteRule ^rml/(.*)$ /rml/$1.cc.conneg [NE,R,L]


# === RML core ===
RewriteCond %{REQUEST_URI} ^/rml/core
RewriteRule ^rml/core/?$ https://kg-construct.github.io/rml-core/ontology/documentation/index-en.html [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/core/spec
RewriteRule ^rml/core/spec/?$ https://kg-construct.github.io/rml-core/spec/docs [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/core/shapes
RewriteRule ^rml/core/shapes/?$ https://kg-construct.github.io/rml-core/shapes/core.ttl [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/core/bc
RewriteRule ^rml/core/bc/?$ https://kg-construct.github.io/rml-core/ontology/rml-core-bc.ttl [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/(logicalSource|logicalTarget|subject|subjectMap|predicateObjectMap|graph|graphMap|class|predicate|predicateMap|object|objectMap|parentTriplesMap|joinCondition|parentMap|parent|childMap|child|datatype|datatypeMap|language|languageMap|termType|template|reference|constant|strategy|TriplesMap|SubjectMap|PredicateObjectMap|PredicateMap|ObjectMap|RefObjectMap|Join|LanguageMap|GraphMap|Strategy|DatatypeMap|ParentMap|ChildMap|TermMap|ExpressionMap|IRI|Literal|BlankNode)$
RewriteRule ^rml/(.*)$ /rml/$1.core.conneg [NE,R,L]


# === RML eval17 ===
RewriteRule ^editor/eval17/?$ https://w3id.org/rml/editor/eval17 [NE,L,R=301]


# === RML fnml ===
RewriteCond %{REQUEST_URI} ^/rml/fnml
RewriteRule ^rml/fnml/?$ https://kg-construct.github.io/rml-fnml/ontology/documentation/index-en.html [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/fnml/spec
RewriteRule ^rml/fnml/spec/?$ https://kg-construct.github.io/rml-fnml/spec/docs [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/fnml/shapes
RewriteRule ^rml/fnml/shapes/?$ https://kg-construct.github.io/rml-fnml/shapes/fnml.ttl [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/(returnMap|functionExecution|input|functionMap|parameterMap|function|parameter|return|inputValueMap|inputValue|ReturnMap|FunctionExecution|Input|ParameterMap|FunctionMap)$
RewriteRule ^rml/(.*)$ /rml/$1.fnml.conneg [NE,R,L]


# === RML io ===
RewriteCond %{REQUEST_URI} ^/rml/io
RewriteRule ^rml/io/?$ https://kg-construct.github.io/rml-io/ontology/documentation/index-en.html [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/io/spec
RewriteRule ^rml/io/spec/?$ https://kg-construct.github.io/rml-io/spec/docs [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/io/shapes
RewriteRule ^rml/io/shapes/?$ https://kg-construct.github.io/rml-io/shapes/io.ttl [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/io/bc
RewriteRule ^rml/io/bc/?$ https://kg-construct.github.io/rml-io/ontology/rml-io-bc.ttl [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/(source|target|encoding|compression|serialization|null|referenceFormulation|iterator|namespacePrefix|namespaceURL|namespace|LogicalSource|LogicalTarget|ReferenceFormulation|Source|Target|Namespace|Encoding|Compression|JSONPath|XPath|XPathReferenceFormulation|CSV|SQL2008Table|SQL2008Query|UTF-8|UTF-16|none|gzip|zip|tarxz|targzip)$
RewriteRule ^rml/(.*)$ /rml/$1.io.conneg [NE,R,L]


# === RML resources ===
RewriteRule ^rml//?$ https://kg-construct.github.io/rml-resources/ontology.ttl [NE,L,R=301]

RewriteRule ^rml/bc/?$ https://kg-construct.github.io/rml-resources/backwards-compatibility.ttl [NE,L,R=301]

RewriteRule ^rml/portal/?(.*)/?$ https://kg-construct.github.io/rml-resources/portal/$1 [NE,L,R=301]

RewriteRule ^rml/shapes/?$ https://kg-construct.github.io/rml-resources/shapes.ttl [NE,L,R=301]

RewriteRule ^rml/resources/?(.*)/?$ https://kg-construct.github.io/rml-resources/resources/$1 [NE,L,R=301]


# === RML star ===
RewriteCond %{REQUEST_URI} ^/rml/star
RewriteRule ^rml/star/?$ https://kg-construct.github.io/rml-star/ontology/documentation/index-en.html [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/star/spec
RewriteRule ^rml/star/spec/?$ https://kg-construct.github.io/rml-star/spec/docs [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/star/shapes
RewriteRule ^rml/star/shapes/?$ https://kg-construct.github.io/rml-star/shapes/star.ttl [NE,R,L]
RewriteCond %{REQUEST_URI} ^/rml/(quotedTriplesMap|StarMap|AssertedTriplesMap|NonAssertedTriplesMap)$
RewriteRule ^rml/(.*)$ /rml/$1.star.conneg [NE,R,L]


RewriteRule ^rml/(.*)$ https://kg-construct.github.io/rml-resources/404.html [NE,L,R=404]
