# W3ID .htaccess for chem-dcat-ap 
# DCAT-AP Plus Links to ...........................................
# Maintained by: NFDI4Chem & NFDI4Cat
# GitHub: https://github.com/nfdi-de/chem-dcat-ap 
# Contact: Koepler, Oliver <Oliver.Koepler@tib.eu>

Header set Access-Control-Allow-Origin "*"

# Enable rewrite engine
Options +FollowSymLinks
RewriteEngine on

# ====================================
# General HTML redirect to GitHub pages Documentation
# ====================================

# Default redirect to documentation (HTML)
# Matches: https://w3id.org/nfdi-de/chem-dcat-ap or https://w3id.org/nfdi-de/chem-dcat-ap
RewriteCond %{HTTP_ACCEPT} text/html [OR]
RewriteCond %{HTTP_ACCEPT} application/xhtml\+xml [OR]
RewriteCond %{HTTP_USER_AGENT} ^Mozilla/.*
RewriteRule "^v?([0-9]{1,}\.[0-9]{1,}\.[0-9]{1,})/?.*$"  https://nfdi-de.github.io/chem-dcat-ap/ [R=302,L]

RewriteCond %{HTTP_ACCEPT} text/html [OR]
RewriteCond %{HTTP_ACCEPT} application/xhtml\+xml [OR]
RewriteCond %{HTTP_USER_AGENT} ^Mozilla/.*
RewriteRule ^$ https://nfdi-de.github.io/chem-dcat-ap/ [R=302,L]

# ====================================
# Datamodels
# ====================================

# main linkml yaml schema
RewriteCond %{HTTP_ACCEPT} application/yaml
RewriteRule "^v?([0-9]{1,}\.[0-9]{1,}\.[0-9]{1,})" https://nfdi-de.github.io/chem-dcat-ap/v$1/schema/material_entities_ap.yaml [R=302,L]

# ====================================
# Various artefacts
# ====================================



# HTML - individual documentation for class elements
RewriteCond %{HTTP_ACCEPT} text/html
RewriteRule "^v?([0-9]{1,}\.[0-9]{1,}\.[0-9]{1,})/class/(.*)$" https://nfdi-de.github.io/chem-dcat-ap/v$1/elements/classes/$2 [R=303,L,NE,NC]

# HTML - individual documentation for slot elements
RewriteCond %{HTTP_ACCEPT} text/html
RewriteRule "^v?([0-9]{1,}\.[0-9]{1,}\.[0-9]{1,})/slot/(.*)$" https://nfdi-de.github.io/chem-dcat-ap/v$1/elements/slots/$2 [R=303,L,NE,NC]

# HTML - individual documentation for enum elements
RewriteCond %{HTTP_ACCEPT} text/html
RewriteRule "^v?([0-9]{1,}\.[0-9]{1,}\.[0-9]{1,})/enum/(.*)$" https://nfdi-de.github.io/chem-dcat-ap/v$1/elements/enums/$2 [R=303,L,NE,NC]

# HTML - individual documentation for type elements
RewriteCond %{HTTP_ACCEPT} text/html
RewriteRule "^v?([0-9]{1,}\.[0-9]{1,}\.[0-9]{1,})/type/(.*)$" https://nfdi-de.github.io/chem-dcat-ap/v$1/elements/types/$2 [R=303,L,NE,NC]


# HTML - schema documentation
RewriteCond %{HTTP_ACCEPT} text/html
RewriteRule "^elements.*$" https://nfdi-de.github.io/chem-dcat-ap/latest/elements/overview [R=303,L,NE,NC]

# HTML - general documentation
RewriteCond %{HTTP_ACCEPT} text/html
RewriteRule "^.*$" https://nfdi-de.github.io/chem-dcat-ap/latest [R=303,L,NE,NC]


# ====================================
# Fallback - redirect to main documentation
# ====================================
# Fallback to HTML for version-tagged and latest.
RewriteRule "^v?([0-9]{1,}\.[0-9]{1,}\.[0-9]{1,}).*$" https://nfdi-de.github.io/chem-dcat-ap/v$1 [R=303,L,NE,NC]

RewriteRule "^.*$" https://nfdi-de.github.io/chem-dcat-ap/latest [R=303,L,NE]
